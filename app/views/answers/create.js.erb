<% if @answer.valid? %>
  <% publish_to "/questions/#{@question.id}/answers" do %>
    <% if remotipart_submitted? %>
      $('div.answers div.answers-list').append('<%= j "#{render partial: @answer, locals: { answer: @answer }}" %>');
    <% else %>
      $('div.answers div.answers-list').append('<%= j render partial: @answer, locals: { answer: @answer } %>');
    <% end %>
    $('form#new_answer p textarea').val('');
    $('form#new_answer div input[type="file"]').val('');
  <% end %>
<% else %>
  $('<%= j render 'answers/validation_errors' %>').insertBefore($('#new-answer-form form'));
<% end %>
